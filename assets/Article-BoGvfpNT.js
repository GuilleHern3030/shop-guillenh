import{r as u,j as e,af as ns,b as V,S as D,ab as N,ag as as,a0 as cs,a as z,I as P,ac as is,v as os,ah as ls,ai as rs,k as A,N as H,aj as ds,ak as us,al as ms,u as _s,P as hs,n as gs,W as ps,am as fs}from"./index-EDSmHiRk.js";import{L as js}from"./LogoLoading-DtJ6Xp7u.js";import{P as xs}from"./Price-DF8P5T4V.js";const bs="_datasection_1300l_1",vs="_information_1300l_13",Ns="_description_1300l_21",L={datasection:bs,information:vs,description:Ns},$s="_background_eyaqb_1",Cs="_images_eyaqb_27",ys="_image_eyaqb_27",ks="_disabled_eyaqb_67",O={background:$s,images:Cs,image:ys,disabled:ks},Ss="_imagecontainer_15ijf_1",Fs="_image_15ijf_1",Is="_buttons_15ijf_29",Es="_button_15ijf_29",I={imagecontainer:Ss,image:Fs,buttons:Is,button:Es},As=({className:s,images:t,onImageChange:n,onImageClick:i})=>{const[c,a]=u.useState(0);u.useEffect(()=>{},[c]);const l=(o,h)=>{o.stopPropagation(),a(h===!1?m=>m-1<0?t.length-1:m-1:m=>m+1<t.length?m+1:0)};return e.jsxs("div",{className:`${I.imagecontainer} ${s??""}`,children:[e.jsx("img",{className:I.image,onClick:()=>i(t.length>0?t[c].src:null),src:t.length>0?t[c].src:ns}),e.jsxs("div",{className:I.buttons,onClick:()=>i(t.length>0?t[c].src:null),children:[t.length>1&&e.jsx("button",{className:I.button,onClick:o=>l(o,!1),children:"<"}),t.length>1&&e.jsx("button",{className:I.button,onClick:o=>l(o,!0),children:">"})]})]})},Vs=({images:s})=>{const[t,n]=u.useState(null);return e.jsxs("div",{className:s.length>0?"":O.disabled,children:[e.jsx(As,{className:O.images,images:s,onImageClick:n}),t&&e.jsx(qs,{image:t,onClose:()=>n(null)})]})},qs=({image:s,onClose:t})=>e.jsx("div",{className:O.background,onClick:t,children:e.jsx("img",{className:O.image,src:s})}),ws="_slug_omglp_1",Os="_categories_omglp_21",Ls="_category_omglp_31",Bs="_separator_omglp_31",Ps="_id_omglp_51",Rs="_exit_omglp_63",y={slug:ws,categories:Os,category:Ls,separator:Bs,id:Ps,exit:Rs},Ts=({index:s,code:t,onBack:n})=>{const[i,c]=u.useState(),a=V();return u.useEffect(()=>{const l=D.slugToArray(N.parse(s).slug),o=[];l.forEach((h,m)=>{const r=D.lastSlug(h);o.push(e.jsx("p",{onClick:()=>a(`/category/${h}${as()}`),className:y.category,children:r},m)),o.push(e.jsx("p",{className:y.separator,children:"/"},m+h.length))}),o.pop(),c(o)},[s]),e.jsxs("div",{className:y.slug,children:[e.jsx("div",{className:y.categories,children:i}),e.jsx("p",{className:y.id,onClick:n,children:t}),e.jsxs("div",{className:y.exit,onClick:n,children:[e.jsx("span",{}),e.jsx("span",{})]})]})},Us="_container_4qra4_1",Ds="_name_4qra4_11",zs="_selectable_4qra4_21",B={container:Us,name:Ds,selectable:zs},Ws="_star_1lliu_1",Ms="_active_1lliu_79",W={star:Ws,active:Ms};function Qs({checked:s,onChange:t,size:n=32}){const i=s!==void 0,[c,a]=u.useState(!1),l=i?s:c;function o(){i||a(!c),t?.(!l)}return e.jsx("button",{className:`${W.star} ${l?W.active:""}`,style:{"--size":`${n}px`},onClick:o,"aria-pressed":l,"aria-label":l?"Quitar favorito":"Marcar como favorito"})}const Gs=({id:s,name:t,onFavouriteChange:n})=>{const i=V(),c=()=>{z()&&i("/admin/products/"+s)};return e.jsxs("div",{className:B.container,children:[e.jsxs("h2",{onClick:c,className:`${B.name} ${z()?B.selectable:""}`,children:[" ",t]}),cs&&e.jsx(Qs,{onChange:n})]})},Hs="_options_fz571_1",Js="_title_fz571_9",M={options:Hs,title:Js},Ks="_filters_1prfj_1",Xs="_filter_1prfj_1",Ys="_hr_1prfj_27",Zs="_clean_1prfj_35",se="_menu_1prfj_65",ee="_rotated_1prfj_103",te="_selector_1prfj_111",ne="_value_1prfj_121",ae="_available_1prfj_135",ce="_selected_1prfj_145",ie="_unavailable_1prfj_157",j={filters:Ks,filter:Xs,hr:Ys,clean:Zs,menu:se,rotated:ee,selector:te,value:ne,available:ae,selected:ce,unavailable:ie},oe=({values:s,prevValue:t,availables:n,onSelect:i,onCancel:c})=>e.jsx("div",{className:j.selector,onClick:c,children:s.map((a,l)=>a!=t?e.jsx("p",{className:`${j.value} ${n?.includes(a)?j.available:j.unavailable}`,onClick:()=>i(a,n?.includes(a)),children:a},l):e.jsx("p",{className:`${j.value} ${j.selected}`,onClick:()=>i(void 0),children:a},l))}),le=({attribute:s,values:t,prevValue:n,availables:i,onChange:c,filters:a})=>{u.useEffect(()=>{o(void 0)},[a]);const[l,o]=u.useState(),[h,m]=u.useState(),r=d=>{l&&d==l&&o(void 0),l||o(d)},_=(d,g,S)=>{o(void 0),c(d,g,S)};return u.useEffect(()=>{m(l?e.jsx(oe,{availables:i,values:t,prevValue:n,onSelect:(d,g)=>_(s,d,g),onCancel:()=>m(null)}):void 0)},[l]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:j.filter,onClick:()=>r(s),children:[e.jsx("p",{children:s}),e.jsxs("div",{className:j.menu,children:[e.jsx("p",{children:n??""}),e.jsx("p",{className:l?j.rotated:"",children:e.jsx("b",{children:">"})})]})]}),h,e.jsx("hr",{className:j.hr})]})},$={url(){const s=re();try{delete s.o}catch{}try{delete s.p}catch{}return Object.entries(s).length>0?s:null},selectVariants(s,t){const n=s.variants??s;return t?n.filter(c=>Object.entries(t).every(([a,l])=>c.attributes.some(o=>o.attributeName===a&&o.valueName===l))):n},selectVariant(s,t){const n=this.selectVariants(s,t);return n?.length>0?n[0]:null},unselectVariants(s,t){const n=s.variants??s;if(Object.keys(t).length==0)return n;const i=this.selectVariants(s,t);return n.filter(c=>i.find(a=>a.id==c.id))},availableAttributes(s){const n=(s.variants??s).map(c=>c.attributes).flat(),i={};return n.forEach(({attributeName:c,valueName:a})=>{i[c]??=[],i[c].includes(a)||i[c].push(a)}),i},availableFilters(s,t){const n=this.unselectVariants(s,t);return this.availableAttributes(n)},getFilters(s){return s?Object.fromEntries(s.attributes.map(n=>[n.attributeName,n.valueName])):{}}},re=()=>{const s={},t=window.location.href,n=t.indexOf("?")+1;return n>window.location.hostname.length&&new URLSearchParams(t.substring(n)).forEach((c,a)=>{s[a]=c}),s},de=({article:s,filters:t,onChange:n,onClean:i,t:c})=>{const[a,l]=u.useState(),[o,h]=u.useState($.availableAttributes(s));u.useLayoutEffect(()=>{l($.availableFilters(s,t))},[t]);const m=(r,_,d)=>{if(d){const g={...t};if(g[r]=_??void 0,g[r]===void 0)try{delete g[r]}catch{}const S={...g};n(S)}else{const g={};g[r]=_,n(g)}};return s.variants?.length>0&&a&&e.jsxs("div",{className:j.filters,children:[e.jsx("hr",{className:j.hr}),o&&Object.entries(o).map(([r,_],d)=>e.jsx(le,{filters:t,attribute:r,values:_??[],prevValue:t[r],availables:a[r],onChange:m},d)),Object.keys(t).length>0&&e.jsx("p",{className:j.clean,onClick:i,children:c("clean_filters")})]})},ue="_articles_1clgg_1",me="_carousel_1clgg_23",Q={articles:ue,carousel:me},_e="_article_1m66i_1",he="_selected_1m66i_33",ge="_info_1m66i_41",pe="_image_1m66i_51",fe="_price_1m66i_79",je="_strike_1m66i_87",xe="_filters_1m66i_127",be="_line_1m66i_139",ve="_value_1m66i_147",b={article:_e,selected:he,info:ge,image:pe,price:fe,strike:je,filters:xe,line:be,value:ve},Ne=(s,t=void 0,n=0)=>{try{return s.images[n]?.src??t}catch{return t}},G=(s,t)=>s.discount>0?(Number(s.price)-Number(s.price)*s.discount/100).toFixed(t):Number(s.price).toFixed(t),$e=({article:s,summary:t,digits:n,onSelect:i,alt:c,selected:a=!1})=>{const{t:l}=os(),{decimals:o,dataLoaded:h,coinSymbol:m}=P();return h&&e.jsxs("article",{id:s.id,className:`${b.article} ${a?b.selected:""}`,onClick:()=>i(s),children:[e.jsx(is,{src:Ne(s,c),alt:s.name,className:b.image,bottomText:s.discount>0&&s.price?`-${s.discount}%`:null,topText:s.newest===!0?l("common:new"):null}),!t&&e.jsxs("div",{className:b.info,children:[e.jsx("p",{className:b.name,children:s.name}),s.price&&e.jsx("div",{className:b.price,children:s.discount>0?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:b.strike,children:s.price}),e.jsx("p",{children:`${G(s,o)} ${m}`})]}):e.jsx("p",{children:`${G(s,o)} ${m}`})}),s.attributes&&e.jsx("div",{className:b.filters,children:s.attributes.map((r,_)=>e.jsx("p",{className:b.line,children:e.jsx("span",{className:b.value,children:r.valueName})},_))})]})]})},Ce=({articles:s,variant:t,onSelect:n,alt:i})=>{const[c,a]=u.useState(),[l,o]=u.useState(),{dataLoaded:h,decimals:m}=P();V();const r=ls();return u.useEffect(()=>{r<330?a(1):r<480?a(2):r<768?a(3):a(4)},[r]),u.useEffect(()=>{o(s.map((_,d)=>e.jsx($e,{selected:t.id==_.id,article:_,digits:m,alt:i,onSelect:n},d)))},[t,s]),h&&c&&s?.length>1&&e.jsx("aside",{className:Q.articles,children:s.length>c?e.jsx(rs,{visible:c,items:l}):e.jsxs("div",{className:Q.carousel,children:[" ",l," "]})})},ye=({article:s,variant:t,categories:n,onSelect:i,t:c})=>{const[a,l]=u.useState({}),[o,h]=u.useState(s.variants),m=_=>{const d=$.selectVariants(s,_);if(l(_),h(d),A("[Options] filters:",_),A("[Options] filteredVariants:",d),d.length==1){const g=d[0];i(g),l($.getFilters(g))}else H("options")},r=()=>{l({}),h(s.variants)};return s.variants.length>1&&e.jsxs("section",{className:M.options,id:"options",children:[e.jsx("h2",{className:M.title,children:c("options")}),e.jsxs(e.Fragment,{children:[e.jsx(de,{article:s,filters:a,onChange:m,onClean:r,t:c}),e.jsx(Ce,{articles:o,variant:t,onSelect:i,alt:s.images[0].src})]})]})},ke="_filters_hil3q_1",Se="_line_hil3q_13",Fe="_attribute_hil3q_21",Ie="_value_hil3q_29",w={filters:ke,line:Se,attribute:Fe,value:Ie},Ee=({variant:s})=>{const[t,n]=u.useState({});return u.useEffect(()=>{n($.getFilters(s))},[s]),e.jsx("div",{className:w.filters,children:Object.entries(t).map(([i,c],a)=>e.jsxs("p",{className:w.line,children:[e.jsx("span",{className:w.attribute,children:i}),e.jsx("span",{className:w.value,children:c})]},a))})},Ae="_buy_139hx_1",Ve="_button_139hx_9",qe="_exit_139hx_49",k={buy:Ae,button:Ve,exit:qe},we=({article:s,variant:t,onBuy:n,onAddShoppingCart:i,onConsult:c,onBack:a,className:l,t:o})=>e.jsxs("div",{className:k.buy,children:[ds&&e.jsx("p",{className:`${k.button}`,onClick:()=>i(s,t),children:o("add_cart")}),us&&e.jsx("p",{className:`${k.button}`,onClick:()=>n(s,t),children:o("buy")}),ms&&e.jsx("p",{className:`${k.button}`,onClick:()=>c(s,t),children:o("consult")}),e.jsx("div",{className:k.exit,children:e.jsx("p",{className:`${k.button}`,onClick:a,children:o("back")})})]}),Oe="_error_q9e6r_1",Le="_title_q9e6r_17",Be="_button_q9e6r_25",E={error:Oe,title:Le,button:Be},Pe=({t:s})=>{const t=V();return e.jsxs("section",{className:E.error,children:[e.jsx("h2",{className:E.title,children:s("error_title")}),e.jsx("p",{className:E.message,children:s("error_message_1")}),e.jsx("p",{className:E.message,children:s("error_message_2")}),e.jsx("button",{className:`button_square_white ${E.button}`,onClick:()=>t("/",{replace:!0}),children:s("error_button")})]})},Re={parse(s,t,n){return n>1?[...t,...s]:n==1?[...s,...t]:s}},Te=s=>document.getElementById("header")?.scrollIntoView({behavior:"smooth"}),We=()=>{const{t:s,ready:t}=_s("main/article"),{dataLoaded:n,contactlink:i,fees:c}=P(),{"*":a}=hs(),l=gs(),o=V(),[h,m]=u.useState(N.id(a)),[r,_]=u.useState(),[d,g]=u.useState(),[S,R]=u.useState(),{getArticle:J,isLoading:K}=ps(),X=fs();u.useEffect(()=>{Te();try{const{slug:f,id:x,variantId:v}=N.parse(a);x?J(x).then(p=>{p.variants.forEach(C=>C.name=C.name??p.name),A("ARTICLE",p);const F=p.categories?.map(C=>C.slug),q=$.url(),U=(v?p.variants.find(C=>C.id==v):q?$.selectVariant(p.variants,q):p.variants[0])??p.variants[0];A("VARIANT",U),R(F),_(p),g(U)}).catch(p=>{console.error(p),_(null)}):(console.warn("No article selected"),o(-1))}catch(f){console.warn(f),o("/category",{replace:!0})}},[h]),u.useEffect(()=>{const{slug:f,id:x,variantId:v}=N.parse(a),p=f?`/${f}`:"",F=`${N.id(a)}${d?.id??""}`;o(`/article${p}/${F}`,{replace:!0,state:{from:l.state?.from}})},[d]);const Y=(f,x,v=1)=>{X.add(f,v,x).then(()=>{A("Cart added:",f,x,v)}).catch(p=>{console.error(p)})},Z=(f,x)=>{},ss=(f,x)=>{const{id:v,slug:p}=N.parse(a),F=N.url(v,p,x?.id),q=encodeURIComponent(F);window.open(i+`?text=${s("consult_message")}: 
\r`+q,"_blank")},es=()=>{},T=()=>{const{slug:f}=N.parse(a),x=l.state?.from;o(x||(f?`/category/${f}`:"/"))},ts=f=>{H("article"),g(f)};return e.jsxs("main",{children:[(!t||!n||K)&&e.jsx(js,{}),r!=null&&e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:L.datasection,id:"article",children:[e.jsx(Vs,{images:Re.parse(r?.images??[],d?.images??[],r.variants?.length??0)}),e.jsxs("article",{className:L.information,children:[e.jsx(Ts,{index:a,onBack:T}),e.jsx(Gs,{id:r.id,name:d?.name??r?.name,onFavouriteChange:es}),e.jsx(xs,{price:d?.price??r.price,discount:d?.discount??r.discount,fees:c,t:s}),e.jsx("p",{className:L.description,children:d?.description??r.description}),e.jsx(Ee,{variant:d}),e.jsx(we,{article:r,variant:d,onBuy:Z,onAddShoppingCart:Y,onConsult:ss,onBack:T,t:s})]})]}),e.jsx(ye,{article:r,variant:d,categories:S,onSelect:ts,t:s})]}),r===null&&e.jsx(Pe,{t:s})]})};export{We as default};
