import{j as t,I as Ce,ac as Fe,v as ye,ad as Ee,r as d,b as ve,S as De,W as Ne,u as Ie,J as _e,g as Oe,ae as Le,w as Pe,k as T}from"./index--svHLFhj.js";import{L as xe}from"./LogoLoading-C_6Bo3vy.js";const Re="_main_1b4c7_1",Te="_collection_1b4c7_11",ze="_filters_1b4c7_19",Je="_articles_1b4c7_27",U={main:Re,collection:Te,filters:ze,articles:Je},pe=i=>new b({id:void 0,name:i,disabled:!1});class b{#e;constructor(e){if(!e)return null;if(b.isAttributeValue(e))return new b(e.toJson());if(typeof e=="string")return pe(e);this.#e=e}static new(e){return pe(e.toString())}static isAttributeValue(e){return e instanceof b}toJson=()=>this.#e;toString=()=>this.#e.name;name=()=>this.#e.name;id=()=>this.#e.id;isActive=()=>this.#e.disabled!==!0;enable=()=>{this.#e.disabled=!1};disable=()=>{this.#e.disabled=!0};rename=e=>{this.#e.name=e}}const z=(i,e)=>{let s=null,n=!1,l=0;if(i&&e){for(l=0;l<i.length;l++)if(s=i[l],b.isAttributeValue(e)&&s.name==e.name()||typeof e=="string"&&s.name==e){n=!0;break}}return n==!0?{valueData:s,index:l}:{valueData:void 0,index:-1}};class $e extends Array{static get(e,s){return z(e,s)}toArray=()=>this.map(e=>new b(e));get=e=>{const{valueData:s}=z(this,e);return s?new b(s):null};has=(e,s=!0)=>{const n=this.get(e);return n?s===!0?n.isActive():!0:!1};rename=(e,s)=>{this.get(e).rename(s)};disableAll=()=>{this.forEach(e=>{e.disabled=!0})};enableAll=()=>{this.forEach(e=>{e.disabled=!1})};remove=e=>{const{index:s}=z(this,e);s>=0&&this.splice(s,1)};add=e=>{const{index:s}=z(this,e);s==-1&&this.push(new b(e).toJson())};disable=e=>{const{valueData:s}=z(this,e);s&&(s.disabled=!0)};enable=e=>{const{valueData:s}=z(this,e);s&&(s.disabled=!1)}}const Be=i=>new j({id:void 0,name:i,AttributeValues:[],disabled:!1});class j{#e;constructor(e){if(j.isAttribute(e))return new j(e.toJson());if(typeof e=="string")return Be(e);if(!e)throw new Error("Undefined Attribute object");this.#e=e}static isAttribute(e){return e instanceof j}toJson=()=>this.#e;id=()=>this.#e.id;name=()=>this.#e.name;categories=()=>this.#e.category??[];slugs=()=>this.#e.category?.map(e=>e.slug)??[];rawValues=()=>this.#e.AttributeValues??[];values=(e=!0)=>{const s=this.#e.AttributeValues??this.#e.values,n=e!==!0?s:s.filter(l=>l.disabled!==!0);return Object.assign(new $e,n)};isActive=e=>e?this.getValue(e)?.isActive():this.#e.disabled!==!0&&!0;rename=e=>(e?.length>0&&(this.#e.name=e),this.slice());disable=(e=!1)=>(this.#e.disabled=!0,e===!0&&this.values().disableAll(),this.slice());enable=(e=!1)=>(this.#e.disabled=!1,e===!0&&this.values().enableAll(),this.slice());hasValue=(e,s=!0)=>this.values().has(e,s);getValue=e=>this.values(!1).get(e);get=e=>{if(e){const s=this.valueIndex(e);if(s>=0)return this.#e.AttributeValues[s]}};valueIndex=e=>{if(e)try{const s=typeof e=="string"||typeof e=="number"?e:e.name;let n=0;for(n=0;n<this.#e.AttributeValues.length;n++)if(typeof e=="number"&&this.#e.AttributeValues[n].id==s||this.#e.AttributeValues[n].name==s)return n}catch(s){console.warn(s)}return-1};addValue=e=>(this.#e.AttributeValues.push(b.new(e).toJson()),this.slice());removeValue=e=>{const s=this.valueIndex(e);return s>=0&&this.#e.AttributeValues.splice(s,1),this.slice()};renameValue=(e,s)=>{if(!this.hasValue(s)){const n=this.valueIndex(e);n>=0&&(this.#e.AttributeValues[n].name=typeof s=="string"?s:s.toString())}return this.slice()};disableValue=e=>{const s=this.valueIndex(e);return s>=0&&(this.#e.AttributeValues[s].disabled=!0),this.slice()};enableValue=e=>{const s=this.valueIndex(e);return s>=0&&(this.#e.AttributeValues[s].disabled=!1),this.slice()};slice=()=>new j(this)}const J=(i,e)=>{let s=!1,n=0;if(i&&e){for(n=0;n<i.length;n++)if(j.isAttribute(e)&&i[n].name==e.name()||typeof e=="string"&&i[n].name==e||typeof e=="number"&&i[n].id==e){s=!0;break}}return s==!0?{attributeData:i[n],index:n}:{attributeData:void 0,index:-1}},Q=(i,e,s)=>{const{attributeData:n}=J(i,e),{valueData:l,index:o}=$e.get(n?.AttributeValues,s);return{attributeData:n,valueData:l,index:o}};class ie extends Array{static get(e,s){return J(e,s)}static isAttributes(e){return e instanceof ie}static toFilters(e,s){const n=Object.assign(new ie,s);let l={};return Object.entries(e).forEach(([o,r])=>{const a=n.getFilter(o,r);l={...l,...a}}),l}toArray=()=>this.map(e=>new j(e));get=e=>{const{attributeData:s}=J(this,e);return s?new j(s):null};has=(e,s=!0)=>{const n=this.get(e);return n?s===!0?n.isActive():!0:!1};attributeIndex=e=>{const{index:s}=J(this,e);return s};rename=(e,s)=>{const{attributeData:n}=J(this,e);return n&&(n.name=s),this.slice()};add=e=>(this.has(e)||this.push(new j(e).toJson()),this.slice());remove=e=>{const{index:s}=J(this,e);return s>=0&&this.splice(s,1),this.slice()};disable=(e,s=!1)=>{const n=this.get(e);return n?.isActive()&&n.disable(s),this.slice()};enable=(e,s=!1)=>{const n=this.get(e);return n&&!n.isActive()&&n.enable(s),this.slice()};hasValue=(e,s,n=!0)=>{const l=this.get(e);return l?l.hasValue(s,n):!1};getFilter=(e,s,n=!0)=>{const l=this.get(e);if(l&&l.hasValue(s,n))return JSON.parse(`{ "${l.id()}":${l.getValue(s.toString()).id()} }`)};addValue=(e,s)=>{const{valueData:n,attributeData:l}=Q(this,e,s);return l&&!n&&l.AttributeValues.push(new b(s).toJson()),this.slice()};removeValue=(e,s)=>{const{index:n,attributeData:l}=Q(this,e,s);return n>=0&&l.AttributeValues.splice(n,1),this.slice()};disableValue=(e,s)=>{const{index:n,valueData:l}=Q(this,e,s);return n>=0&&(l.disabled=!0),this.slice()};enableValue=(e,s)=>{const{index:n,valueData:l}=Q(this,e,s);return n>=0&&(l.disabled=!1),this.slice()};renameValue=(e,s,n)=>{const{index:l,valueData:o}=Q(this,e,s);return console.log(l),l>=0&&(o.name=n),this.slice()}}const se=[{id:0,key:"by_default"},{id:1,key:"price",order:"asc"},{id:2,key:"price",order:"desc"},{id:3,key:"discount",order:"asc"},{id:4,key:"discount",order:"desc"}],ue={get(i){return se[i]??se[0]},getAll(i){return i?se:se.filter(e=>e.key!="discount")}},qe="_articles_1baxc_1",We="_article_1baxc_1",He="_selected_1baxc_33",Me="_info_1baxc_41",Ue="_image_1baxc_51",Qe="_price_1baxc_79",Ge="_strike_1baxc_87",Ke="_empty_1baxc_99",A={articles:qe,article:We,selected:He,info:Me,image:Ue,price:Qe,strike:Ge,empty:Ke},Xe="_pages_z85nj_1",Ye="_selector_z85nj_17",Ze="_selected_z85nj_25",es="_selectable_z85nj_41",ss="_navigate_z85nj_63",ts="_dots_z85nj_79",ns="_hide_z85nj_89",k={pages:Xe,selector:Ye,selected:Ze,selectable:es,navigate:ss,dots:ts,hide:ns},is=({page:i,pages:e,onChange:s,className:n,t:l})=>e>1&&t.jsxs("section",{className:`${k.pages} ${n??""}`,children:[t.jsx("div",{className:`${i<=1?k.hide:k.navigate}`,onClick:()=>{i>1&&s(i-1)},children:t.jsx("p",{children:l("last")})}),t.jsx(ls,{page:i,pages:e,onChange:s}),t.jsx("div",{className:`${i>=e?k.hide:k.navigate}`,onClick:()=>{i<e&&s(i+1)},children:t.jsx("p",{children:l("next")})})]});function ls({page:i,pages:e,onChange:s}){const n=as(i,e);return t.jsx("div",{className:k.selector,children:n.map((l,o)=>{if(l==="...")return t.jsx("p",{className:k.dots,children:"..."},o);const r=l===i;return t.jsx("p",{className:r?k.selected:k.selectable,onClick:()=>!r&&s(l),children:l},o)})})}function as(i,e){const n=[],l=[];let o;for(let r=1;r<=e;r++)(r===1||r===e||r>=i-2&&r<=i+2)&&n.push(r);for(let r of n)o&&(r-o===2?l.push(o+1):r-o!==1&&l.push("...")),l.push(r),o=r;return l}const cs=(i,e=void 0,s=0)=>{try{return i.images[s]?.src??e}catch{return e}},be=(i,e)=>i.discount>0?(Number(i.price)-Number(i.price)*i.discount/100).toFixed(e):Number(i.price).toFixed(e),rs=({article:i,summary:e,digits:s,onSelect:n,alt:l,selected:o=!1})=>{const{t:r}=ye(),{decimals:a,dataLoaded:_,coinSymbol:p}=Ce();return _&&t.jsxs("article",{id:i.id,className:`${A.article} ${o?A.selected:""}`,onClick:()=>n(i.id),children:[t.jsx(Fe,{src:cs(i,l),alt:i.name,className:A.image,bottomText:i.discount>0&&i.price?`-${i.discount}%`:null,topText:i.newest===!0?r("common:new"):null}),!e&&t.jsxs("div",{className:A.info,children:[t.jsx("p",{className:A.name,children:i.name}),i.price&&t.jsx("div",{className:A.price,children:i.discount>0?t.jsxs(t.Fragment,{children:[t.jsx("p",{className:A.strike,children:i.price}),t.jsx("p",{children:`${be(i,a)} ${p}`})]}):t.jsx("p",{children:`${be(i,a)} ${p}`})})]})]})},os=({onClick:i})=>{const e=Ee(),[s,n]=d.useState(e),[l,o]=d.useState(s===!1),{t:r}=ye();return d.useEffect(()=>{e===!1&&o(!0),n(e)},[e]),t.jsxs("div",{className:A.empty,children:[t.jsx("p",{children:r(s&&!l?"error:no_articles":"error:no_articles_offline")}),t.jsx("button",{onClick:i,className:"button_square_white",children:r("common:search-other")})]})},ds=({className:i,articles:e,columns:s=2,digits:n,onSelect:l,onEmptyClick:o,pages:r,page:a,onPageChange:_,t:p})=>{const[y,v]=d.useState(),F=x=>{x.matches?v(!1):v(!0)};return d.useEffect(()=>{const x=window.matchMedia("(max-width: 768px)");x.addEventListener("change",F),F(x)},[]),!e||e.length==0?t.jsx(os,{onClick:o}):e&&t.jsxs(t.Fragment,{children:[t.jsx("section",{className:`${A.articles} ${i??""}`,style:{gridTemplateColumns:`repeat(${y?s*2:s}, 1fr)`},children:Array.isArray(e)&&t.jsx(t.Fragment,{children:e.length>0&&t.jsx(t.Fragment,{children:e.map((x,N)=>t.jsx(rs,{article:x,summary:s>=3,onSelect:l,digits:n},N))})})}),t.jsx(is,{page:a,pages:r,onChange:_,t:p})]})},us="_name_1yabb_1",hs="_count_1yabb_13",ge={name:us,count:hs},ms=({className:i,slug:e,articlesCount:s,t:n})=>{const[l,o]=d.useState();ve(),d.useEffect(()=>{o(e?De.slugToCollection(e):n(location.pathname.replaceAll("/","")))},[location.pathname]);const r=()=>{};return t.jsxs("section",{className:i,onClick:r,children:[l!=null&&t.jsx("p",{className:ge.name,children:`${n("collection")} ${l}`}),s>0&&t.jsx("p",{className:ge.count,children:`${s} ${n("articles")}`})]})},fs="_filters_box_2iopv_1",_s="_filters_liststyle_2iopv_13",xs="_filters_2iopv_1",oe={filters_box:fs,filters_liststyle:_s,filters:xs},ps="_box_container_1xyvx_1",bs="_box_border_1xyvx_9",gs="_box_unselected_1xyvx_23",js="_box_selected_1xyvx_31",le={box_container:ps,box_border:bs,box_unselected:gs,box_selected:js},ys=(i,e)=>{const s=[];for(let n=0;n<i*i;n++)s.push(t.jsx("div",{className:e===!0?le.box_selected:le.box_unselected,style:{margin:`${.15/i}em`}},n));return s},de=({className:i="",onClick:e=()=>{},boxes:s=1,selected:n=!1})=>t.jsx("div",{className:`${i} ${le.box_container}`,children:t.jsx("div",{className:le.box_border,style:{gridTemplateColumns:`repeat(${s}, ${1.5/s}em)`,gridTemplateRows:`repeat(${s}, ${1.5/s}em)`},onClick:e,children:ys(s,n)})}),vs="_filters_vdupt_9",Ns="_background_vdupt_25",$s="_list_vdupt_51",As="_list_hide_vdupt_85",ks="_sublist_vdupt_93",Ss="_title_vdupt_101",Vs="_amount_vdupt_115",ws="_items_vdupt_127",Cs="_selected_vdupt_135",Fs="_clicked_vdupt_145",Es="_unselected_vdupt_155",Ds="_transparent_vdupt_163",Is="_item_vdupt_127",Os="_attribute_vdupt_185",Ls="_apply_vdupt_193",Ps="_back_vdupt_25",c={filters:vs,background:Ns,list:$s,list_hide:As,sublist:ks,title:Ss,amount:Vs,items:ws,selected:Cs,clicked:Fs,unselected:Es,transparent:Ds,item:Is,attribute:Os,apply:Ls,back:Ps},Rs="_icon_kx165_1",Ts="_span_kx165_25",te={icon:Rs,span:Ts},zs=()=>t.jsxs("div",{className:te.icon,children:[t.jsx("span",{className:te.span}),t.jsx("span",{className:te.span}),t.jsx("span",{className:te.span})]});function ne(i,e){const s=Object.keys(i),n=Object.keys(e);if(s.length!==n.length)return!1;for(const l of s)if(i[l]!==e[l])return!1;return!0}const Js=({attributes:i=[],order:e,filters:s,setFilters:n,t:l})=>{const[o,r]=d.useState(!1),[a,_]=d.useState(!1),[p,y]=d.useState(),[v,F]=d.useState(!1),[x,N]=d.useState(!1),[g,G]=d.useState(s?{...s}:{}),[S,B]=d.useState({...e}),q=d.useRef(),K=d.useRef(),{hasPromos:X}=Ne(),V=ue.getAll(X),W=V.map((u,m)=>({name:l(V[m].key)+(V[m].order?` (${l(V[m].order)})`:""),...V[m]})),L=()=>{F(!0)},E=()=>{r(!1),_(!1),F(!1)};d.useEffect(()=>{o&&(G(s?{...s}:{}),B({...e}))},[o]);const Y=()=>{L(),(!ne(s,g)||!ne(e,S))&&n(g,S.id)},D=()=>{L(),(!ne(s,{})||!ne(e,S))&&n({},S.id)};d.useEffect(()=>{_(!1)},[o]);const H=u=>{y({minWidth:`${q.current.clientWidth}px`}),_(u?a&&u.name==a.name?!1:u:a!==null?null:!1)},ae=(u,m)=>{g[u.name]==m.name?delete g[u.name]:g[u.name]=m.name,G({...g})},ce=u=>{B(u)},re=()=>{N(!0)};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:c.filters,onClick:()=>r(!0),children:[t.jsx(zs,{}),t.jsx("p",{children:l("filters")}),Object.keys(s).length>0&&t.jsx("p",{className:c.amount,children:`(${Object.keys(s).length})`})]}),o&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{id:"menu",ref:q,className:`${c.list} ${v?c.list_hide:""}`,onAnimationEnd:()=>{v&&E()},children:[t.jsx("p",{ref:K,className:c.title,children:l("filters")}),t.jsx("hr",{}),t.jsx("div",{className:c.items,children:i.map((u,m)=>t.jsxs("div",{className:c.item,onClick:()=>H(u),children:[t.jsx("p",{className:`${c.attribute} ${g[u.name]!=null?c.selected:""} ${a===!1?"":a?.name==u.name?c.clicked:c.unselected}`,children:u.name}),t.jsx("p",{className:a!==!1&&a?.name!=u.name?c.transparent:"",children:">"})]},m))}),i?.length>0&&t.jsx("hr",{}),t.jsx("div",{className:c.items,children:t.jsxs("div",{className:c.item,onClick:()=>H(null),children:[t.jsx("p",{className:`${c.attribute} ${S.id!=0?c.selected:""} ${a===null?c.clicked:a!=!1?c.unselected:""}`,children:l("orderby")}),t.jsx("p",{className:a!==null&&a!==!1?c.transparent:"",children:">"})]})}),t.jsx("hr",{}),t.jsx("p",{className:c.apply,onClick:Y,children:l("filters_apply")}),t.jsx("p",{className:c.apply,onClick:D,children:l("filters_clean")})]}),!v&&t.jsx("div",{className:c.background,onClick:Y})]}),o&&a!==!1&&!v&&t.jsxs("div",{className:`${c.list} ${c.sublist} ${x?c.list_hide:""}`,style:p,onAnimationEnd:()=>{x&&(_(!1),N(!1))},children:[t.jsx("p",{className:c.title,children:a===null?l("order"):a.name}),t.jsx("hr",{}),t.jsx("div",{className:c.items,children:a!==null?(a.values??a.AttributeValues).map((u,m)=>t.jsx("div",{className:c.item,onClick:()=>ae(a,u),children:t.jsx("p",{className:`${c.attribute} ${g[a.name]==u.name?c.selected:""}`,children:u.name})},m)):W.map((u,m)=>t.jsx("div",{className:c.item,onClick:()=>ce(u),children:t.jsx("p",{className:`${c.attribute} ${S.id==u.id?c.selected:""}`,children:u.name})},m))}),t.jsx("hr",{}),t.jsx("p",{className:`${c.apply} ${c.back}`,onClick:re,children:l("back")})]})]})},Bs=({className:i,attributes:e,columns:s,onChangeColumns:n,onChangeFilters:l,filters:o,order:r,t:a})=>t.jsx("section",{className:i,children:t.jsxs("div",{className:oe.filters,children:[t.jsx("div",{className:oe.filters_box,children:t.jsx(Js,{setFilters:(_,p)=>l(_,p),attributes:e,filters:o,order:ue.get(r),t:a})}),t.jsxs("div",{className:oe.filters_liststyle,children:[" ",t.jsx(de,{onClick:()=>n(1),boxes:1,selected:s==1}),t.jsx(de,{onClick:()=>n(2),boxes:2,selected:s==2}),t.jsx(de,{onClick:()=>n(3),boxes:3,selected:s==3})]})]})}),qs=({className:i,slug:e,onChangeFilter:s,t:n})=>t.jsx("section",{className:i}),Ae="template-columns",Ws=()=>localStorage.getItem(Ae)??2,Hs=i=>localStorage.setItem(Ae,i),je=i=>i?document.getElementById("header")?.scrollIntoView({behavior:"smooth"}):window.scrollTo({top:0}),Qs=({params:i="",parent:e="/",onLoadRequest:s,onAttributesRequest:n=()=>{},onError:l,onEmptySelect:o,onSelect:r})=>{const{t:a,ready:_}=Ie("main/layouts/articles"),[p,y]=d.useState(null),v=ve(),{isLoading:F,error:x}=Ne(),[N,g]=d.useState(Number(Ws()));d.useEffect(()=>{Hs(N)},[N]);const[G,S]=d.useState(),[B,q]=d.useState(),[K,X]=d.useState(),V=h=>{X(h?.articles??h),q(h?.size??h)},[W,L]=d.useState(Number(_e("p"))||1),[E,Y]=d.useState(_e("o")||0),[D,H]=d.useState(Oe("p")),ae=h=>{},ce=async(h,f)=>{y(),H(h),Y(f),L(1),m(i,1,h,f)},re=h=>{je(!0),y(),L(h),m(i,h,D,E)},u=(h,f=D,$=E)=>{je(!1);const w=he(h,$,f);T("Params:",w.length>0?w:null),v(`${location.pathname}${w}`,{replace:!0})};d.useEffect(()=>{m(i,W,D,E)},[i]);const m=async(h,f,$,w)=>{let me=0;y();const Se=(I,P,O,C)=>new Promise((R,ee)=>{V(void 0);const fe=n(I);S(fe);const Ve=ie.toFilters(O,fe),we=C==0?null:ue.get(C);s(P,we,Ve,I??"").then(M=>{R(M),T("Articles loaded:",M)}).catch(M=>{console.warn(M),ee(M)})}),Z=async(I,P,O,C)=>{if(me<5)try{const{articles:R,size:ee}=await Se(I,P,O,C);return ee>0&&R.length>0?(q(ee),X(R),u(P,O,C),!0):P>1?(L(1),Z(I,1,O,C)):Object.keys(O).length>0?(H({}),y(a("no_articles_filter")),Z(I,1,{},C)):(y(a("no_articles")),V(null),l(),!1)}catch(R){me++,setTimeout(async()=>await Z(I,P,O,C),2e3),console.error(R)}else return l(500),!1};await Z(h,f,$,w)},he=(h,f,$)=>Pe.set({p:h>1?h:void 0,...$,o:f!=0?f:void 0}),ke=(h,f)=>{const $=he(W,E,D),w=location.pathname+$;T("Product id:",h),T("Article id:",f),T("Origin:",w),T("Filters:",$??"None"),r(h,f,$,w)};return F===!0||!_?t.jsx(xe,{}):t.jsx(t.Fragment,{children:t.jsxs("main",{className:U.main,children:[t.jsx(ms,{className:U.collection,slug:i,articlesCount:B,t:a}),t.jsx("hr",{}),t.jsx(Bs,{attributes:G,className:U.filters,columns:N,filters:D,order:E,onChangeFilters:(h,f)=>ce(h,f),onChangeColumns:h=>g(h),t:a}),t.jsx("hr",{}),t.jsx(qs,{className:U.filter,onChangeFilter:ae,slug:i,t:a}),x&&t.jsx("p",{className:"error",children:x}),p&&t.jsx("p",{className:"warning",children:p}),K!==void 0?t.jsx(ds,{columns:N,articles:K,className:U.articles,onSelect:ke,onEmptyClick:o,pages:Math.ceil((B??1)/Le),onPageChange:re,page:W,t:a}):t.jsx(xe,{})]})})};export{Qs as L};
